# ssh

## scp

```sh
# 从服务器下载文件
scp 服务器用户名@服务器地址:/tmp/远程.txt ~/本地.txt

# 上传本地文件到服务器
scp ~/本地.txt 服务器用户名@服务器地址:/tmp/远程.txt

# 从服务器下载整个目录
scp -r 服务器用户名@服务器地址:/remote_path/远程目录 ~/本地目录

# 上传目录到服务器
scp  -r ~/本地目录 服务器用户名@服务器地址:/remote_path/远程目录
```

## SCP 使用 SSH 密钥

```sh
scp -i ~/私钥文件 ~/本地.txt 服务器用户名@服务器地址:/tmp/远程.txt
```

## SSH 隧道

SSH 隧道(端口转发)的主要作用是将本地端口的请求转发到目标服务器的指定端口。

命令

```sh
ssh [选项] 本地监听端口:目标服务器IP:目标端口 用户名@SSH服务器地址
```

- `-N` 表示只建立连接，不执行远程命令(专门用于端口转发)
- `-f` 表示在后台运行 SSH 进程，不占用当前终端
- `-L` 表示建立本地端口转发(Local Port Forwarding)

示例

```sh
# 在本地监听 8080 端口
# 所有对本地 8080 端口的请求, 都会通过 SSH 连接发送到 example.com 服务器
# 然后由 example.com 服务器转发到 192.168.1.100 的 80 端口
ssh -N -f -L 8080:192.168.1.100:80 user@example.com
```
