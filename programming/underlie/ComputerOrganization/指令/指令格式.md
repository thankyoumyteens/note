# 指令集

一台计算机的所有指令的集合构成该机的指令系统, 也称为指令集。

# 地址码表示

`A1`指某个主存地址,  `(A1)`表示A1所指向的地址中的内容

# 指令格式

一条指令包括两种信息: 操作码, 地址码

```
[操作码(OP)][地址码(A)]
```

## 零地址指令

```
[OP]
```

1. 不需要操作数, 如空操作、停机、关中断等指令
2. 堆栈计算机, 两个操作数依次存放在栈顶和次栈顶, 计算时取出栈顶的两个操作数, 结果压回栈顶

## 一地址指令

```
[OP][A]
```

1. 只需要单操作数, 如加1、减1、取反、求补等
2. 需要两个操作数, 但其中一个操作数隐含在某个寄存器（如隐含在ACC）

## 二地址指令

```
[OP][A1(目的操作数)][A2(源操作数)]
```

常用于需要两个操作数的算术运算、逻辑运算相关指令

## 三地址指令

```
[OP][A1][A2][A3(结果)]
```

常用于需要两个操作数的算术运算、逻辑运算相关指令

## 四地址指令

```
[OP][A1][A2][A3(结果)][A4(下一个指令的地址)]
```

A4为下一条将要执行指令的地址, 执行指令后, 将PC的值修改位 A4 所指地址

# 按指令长度分类

定长指令字结构: 指令系统中所有指令的长度都相等
变长指令字结构: 指令系统中各种指令的长度不等

# 按操作码长度分类

## 定长操作码

操作码的位数和位置固定, 为能够表示整个指令系统中的全部指令, 指令的操作码字段应当具有足够的位数。

设指令系统共有m条指令, 指令中操作码的位数为N位, 则满足
```
m<=2^N
```

- 优点:编码方法简单, 便于指令的译码
- 缺点: 不方便指令系统中增加新的指令（扩展不方便）

## 变长操作码

四位是基本的操作码, 还可以扩充, 但是指令的字数不变, 就是说把不用的地址码部分可以做操作码用。

# 扩展操作码

在设计扩展操作码指令格式时, 必须注意以下两点

1. 不允许短码是长码的前缀, 即短操作码不能与长操作码的前面部分的代码相同
2. 各指令的操作码一定不能重复

## 例1

假设某机器的指令长度为16位, 包括4位基本操作码和三个4位地址码段。

采用变长操作码实现。可以这样表示: 

- 15条三地址指令的操作码为: `0000 ~ 1110` (操作码剩余的1111, 作扩展操作码, 作为二地址指令的标记)
- 15条二地址指令的操作码为: 前4位1111, 即 `1111 0000 ~ 1111 1110` (操作码剩余的11111111, 做为一地址指令的标记)
- 15条一地址指令的操作码为: 前8位均为1, 即 `1111 1111 0000 ~ 1111 1111 1110` (同上)
- 16条零地址指令的操作码为: 前12位均为1, 即 `1111 1111 1111 0000 ~ 1111 1111 1111 1111`

## 例2

设指令字长固定为16位, 试设计一套指令系统满足: 
1. 有15条三地址指令
2. 有12条二地址指令
3. 有62条一地址指令
4. 有32条零地址指令

15条三地址指令的操作码为: `0000 ~ 1110`

12条二地址指令的操作码为: `1111 0000 ~ 1111 1011`

62条一地址指令的操作码为: `1111 1100 0000 ~ 1111 1111 1101`

零地址指令的操作码为: `1111 1111 1110 0000 ~ 1111 1111 1111 1111`
