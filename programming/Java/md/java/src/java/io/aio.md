# 异步 IO(Asynchronous I/O)

在异步 IO 模型中, 在整个内核的数据处理过程中, 包括内核将数据从物理设备读取到内核缓冲区、将内核缓冲区的数据复制到用户线程缓冲区, 用户程序都不需要阻塞。

以 socket 的 recvfrom 系统调用为例, 流程如下:

1. 当用户线程发起了系统调用, 立刻就可以开始去做其他的事, 用户线程不阻塞
2. 内核开始准备数据, 等到数据准备好了, 内核就会将数据从内核缓冲区复制到用户进程缓冲区
3. 内核会给用户线程发送一个信号, 或者回调用户线程注册的回调接口, 告诉用户线程 IO 操作完成了
4. 用户线程读取用户进程缓冲区的数据, 完成后续的业务操作

![](../../img/5.jpg)

异步 IO 模型在内核等待数据和复制数据的两个阶段, 用户线程都不是阻塞的。用户线程需要接收内核的 IO 操作完成的事件, 或者注册一个 IO 操作完成的回调函数。

异步 IO 模型需要底层内核提供支持, Linux 对 AIO 的支持并不完善。
