# 加载

加载(Loading)阶段是整个类加载过程中的一个阶段，在加载类时，Java虚拟机必须完成以下3件事情：

1. 通过一个类的全限定名来获取定义此类的二进制字节流
2. 将类的二进制数据流解析为方法区内的运行时数据结构
3. 在内存中生成一个代表这个类的java.lang.Class对象，作为方法区这个类的各种数据的访问入口

类的二进制字节流的获取方式：

- 通过文件系统读入一个.class后缀的文件(最常见)
- 读入jar、zip等压缩包，提取类文件
- 从数据库中读取(少见)
- 从网络中获取
- 在运行时生成一段Class的二进制信息(动态代理)

非数组类型的加载阶段既可以使用Java虚拟机里内置的引导类加载器来完成，也可以由用户自定义的类加载器去完成，开发人员通过定义自己的类加载器去控制字节流的获取方式(重写一个类加载器的findClass或loadClass方法)，实现根据自己的想法来赋予应用
程序获取运行代码的动态性。

数组类本身不通过类加载器创建，它是由Java虚拟机直接在内存中动态构造出来的。但数组类中的元素类型最终还是要靠类加载器来完成加载。

数组的元素类型(Element Type)：指的是数组去掉所有维度的类型，如`int[][][]`的元素类型是`int`，`int[]`的元素类型也是`int`。

数组的组件类型(Component Type)：指的是数组去掉一个维度的类型，如`int[][][]`的组件类型为`int[][]`，`int[][]`的组件类型为`int[]`，`int[]`的组件类型是`int`。

一个数组类创建过程遵循以下规则：

- 如果数组的组件类型是引用类型，那就递归采用去加载这个组件类型，数组将被标识在加载该组件类型的类加载器的类名称空间上。
- 如果数组的组件类型不是引用类型，Java虚拟机将会把数组标记为与引导类加载器关联
- 数组类的可访问性与它的组件类型的可访问性一致，如果组件类型不是引用类型，它的数组类的可访问性将默认为public，可被所有的类和接口访问到

加载阶段与连接阶段的部分动作(如一部分字节码文件格式验证动作)是交叉进行的，加载阶段尚未完成，连接阶段可能已经开始，但这些夹在加载阶段之中进行的动作，仍然属于连接阶段的一部分，这两个阶段的开始时间仍然保持着固定的先后顺序。
