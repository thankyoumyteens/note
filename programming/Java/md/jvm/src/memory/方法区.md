# 方法区

方法区(Method Area)与Java堆一样，是各个线程共享的内存区域，它用于存储已被虚拟机加载的类型信息、常量、静态变量、即时编译器编译后的代码缓存等数据。如果方法区无法满足新的内存需求时，将抛出OutOfMemoryError异常。

---

类型信息包括：类(class)、接口(interface)、枚举(enum)、注解(annotation)、域(Field)、方法(Method)。

# 运行时常量池

运行时常量池(Runtime Constant Pool)是方法区的一部分。Class文件中除了有类的版本、字段、方法、接口等描述信息外，还有一项信息是常量池表(Constant Pool Table)，用于存放编译期生成的各种字面量与符号引用，这部分内容将在类加载后存放到方法区的运行时常量池中。进入运行时常量池后，这些字面量与符号引用就会被分配内存地址，符号引用也会变成直接引用。

运行时常量池相对于Class文件常量池的另外一个重要特征是具备动态性，并非只有Class文件中常量池的内容才能进入运行时常量池，运行期间也可以将新的常量放入池中，比如String类的intern()方法。

当运行时常量池无法再申请到内存时会抛出OutOfMemoryError异常。

# Java8使用元空间替换永久代

永久代(Permanent Generation)是在JVM堆中分配的，空间有限，当加载过多的类或者常量的时候，就可能导致永久代的空间不足，抛出OutOfMemoryError异常。而JVM加载的class的总数，方法的大小等都很难确定，因此对永久代大小的指定难以确定。太小的永久代容易导致永久代内存溢出，太大的永久代则容易导致虚拟机内存紧张。

到了JDK 8，终于完全废弃了永久代的概念，改用在本地内存中实现的元空间(Metaspace)，由于元空间使用的是本地内存，而不是JVM内存，其大小只受限于操作系统的实际可用内存，大大减少了内存溢出的可能性。
