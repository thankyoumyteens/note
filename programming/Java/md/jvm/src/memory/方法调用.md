# 方法调用

方法调用阶段唯一的任务就是确定要调用哪一个方法。

主要的方法调用形式：解析和分派。

# 解析

在类加载过程中的解析(Resolution)阶段，JVM会将字节码文件里的一部分符号引用转化为直接引用，这些方法是在编译那一刻就已经确定下来，并且在JVM运行期间是不会改变的。这类方法的调用被称为解析(Resolution)。

符合“编译期可知，运行期不可变”要求的方法，主要有静态方法和私有方法两大类。前者与类型直接关联，后者在外部不可被访问，这两种方法各自的特点决定了它们都不可能通过继承或别的方式重写出其他版本，因此它们都适合在类加载阶段进行解析。

# JVM调用方法的指令

- invokestatic：用于调用静态方法
- invokespecial：用于调用实例构造器`<init>()`方法、私有方法和父类中的方法
- invokevirtual：用于调用所有的虚方法
- invokeinterface：用于调用接口方法，会在运行时再确定一个实现该接口的对象
- invokedynamic：先在运行时动态解析出所引用的方法，然后再执行该方法

# 虚方法

只要能被invokestatic和invokespecial指令调用的方法，都是符合“编译期可知，运行期不可变”要求的方法。

Java语言里符合这个条件的方法共有静态方法、私有方法、实例构造器、父类方法、被final修饰的方法，这5种方法调用会在类加载的时候就可以把符号引用解析为直接引用。这些方法统称为非虚方法(Non-Virtual Method)。与之相反，其他方法就被称为虚方法(Virtual Method)。

其中被final修饰的方法比较特殊，由于历史设计的原因，它使用invokevirtual指令调用。

# 分派

分派（Dispatch）调用可能是静态的也可能是动态的。

## 静态分派

