# 如果你的服务出现了频繁的 Mixed GC，导致 P99 延迟抖动，你会如何排查和优化？

我主要从三个角度看：老年代、对象存活率和配置。

### 1. 看老年代膨胀和回收效率

关键问题：老年代是不是涨得太快，Mixed GC 每次又清不了多少？

- 在 GC 日志里关注：
  - Old regions 占用的变化：比如 `Old regions: 328->323`
  - Mixed GC 之后，老年代占用是否明显下降？
- 如果日志一直显示：
  - Old region 数量维持高位；
  - Mixed GC 之后老年代几乎不降；

那说明：

- 要么老年代里的对象很多是长期存活（回收不了）；
- 要么一次 Mixed GC 能处理的 Old regions 太少（经常是因为 MaxGCPauseMillis 太激进，G1 为了控制停顿时间，只敢回收一点点）。
### 2. 看对象生命周期和分配模式
关键问题：是不是产生了大量“长寿对象”或者“中等寿命对象”？

我会通过：

- 分配速率（allocation rate）和 晋升速率（promotion rate）看：
    - 单位时间内新生代分配多少；
有多少对象在几轮 Young GC 后晋升到老年代。
如果条件允许，会抓一次 heap dump 或用 profiler 看：
哪些类在老年代占用最多；
有没有大 Map、缓存、队列、缓冲区没及时释放。