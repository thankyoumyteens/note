# 死信队列

如果队列里的消息出现以下情况, 那么该消息将成为死信: 

- 消息被否定确认, 使用 channel.basicNack 或 channel.basicReject , 并且此时 requeue 属性被设置为 false
- 消息在队列的存活时间超过设置的 TTL 时间
- 消息队列的消息数量已经超过最大队列长度, 较早的消息可能成为死信

死信消息会被 RabbitMQ 进行特殊处理, 如果配置了死信队列, 那么该消息将会被丢进死信队列中, 如果没有配置, 则该消息将会被丢弃。

配置死信队列的步骤:

- 配置普通的业务队列, 绑定到业务交换机上
- 为业务队列配置死信交换机和路由 key
- 为死信交换机配置死信队列
- 设置消费者消费死信队列

## TTL

TTL(Time To Live), 一条消息如果在 TTL 时间内没有被消费, 则会成为死信。

TTL 超时的情况:

- 消息所在的队列设置了存活时间
- 消息本身设置了存活时间
