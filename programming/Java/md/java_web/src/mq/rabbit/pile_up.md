# 消息堆积

当生产者发送消息的速度超过了消费者处理消息的速度, 就会导致 mq 中的消息堆积。当 mq 存储的消息达到上限, 就会有消息成为死信而丢失。

解决方案: 

1. 增加消费者, 提高消费速度
2. 消费者接收消息后立即交给其它线程(使用线程池)去处理, 自己去继续消费新的消息, 加快消息消费的速度
3. 使用惰性队列, 提高堆积上限

## 惰性队列

mq 中的消息存储在内存中, 所以容量有限。而惰性队列接收到消息后会直接存入磁盘, 等到消费者消费时才会从磁盘读取到内存中。

惰性队列支持数百万条消息的存储。
