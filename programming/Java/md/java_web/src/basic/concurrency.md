# 说一个你在实际项目中用到多线程/并发控制的场景，怎么设计的？

在 XX 系统里有个场景是 **批量生成并下发工单**，一次任务可能涉及几万条数据，如果串行处理，接口响应会非常慢，还可能导致网关超时。

我的做法是：

1. 在业务上把这个操作拆成两部分：
   - 前端只发起“创建批量任务”，接口快速返回一个任务 ID；
   - 真实的工单生成与下发放到后台异步执行。
2. 后台通过自定义线程池处理任务，合理设置 corePoolSize / maxPoolSize / 有界队列，避免把内存打爆。
3. 工单生成过程中涉及同一条业务数据的并发修改，用版本号字段做乐观锁，而不是在业务代码里大面积加锁。
4. 对于任务执行结果，通过状态字段 + 定时任务做兜底检查，如果任务长时间未完成会有告警并重试。

## 深入追问

### 你说你用了线程池，那具体是怎么拆任务、怎么配置线程池参数的？
