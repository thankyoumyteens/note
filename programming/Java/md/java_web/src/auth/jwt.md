# 你是怎么实现基于 JWT + Redis 的登录态管理的？

整体流程大致是：

1. 用户登录成功后，服务端生成一个包含用户 ID、角色、过期时间等信息的 JWT；
2. 将该 JWT 的唯一标识（比如 jti）和用户的权限信息、会话信息一起存入 Redis，设置过期时间；
3. 前端每次请求在 Header 中带上 JWT，网关会：
   - 校验 JWT 是否有效（签名、是否过期）；
   - 根据 jti 去 Redis 校验会话是否存在、是否被踢下线、是否被禁用；
4. 请求进入系统后，通过注解 + AOP 方式，基于用户的角色和权限信息进行接口权限校验；
5. 同时，一些关键接口会通过 AOP 记录操作审计日志（包括操作人、时间、参数摘要、结果等），存入专门的审计日志表或日志平台。

这样设计的好处是：

- JWT 实现「无状态认证」，方便水平扩展；
- Redis 又提供了「可控会话」能力，比如强制下线、权限动态变更等；
- AOP 把审计和异常处理统一起来，减少业务代码的重复。

## 深入追问
