# 控制器

控制器的输入信号:

- 时钟: 完成每个操作都需要占用一定的时间, 各个操作之间有先后次序之分, 因此控制单元需要在时钟的控制下按照一定的顺序发出控制信号
- 指令寄存器(IR): 指令寄存器的操作码字段决定了指令的操作类型，因此是控制单元的输入信号
- 标志: 控制单元有时候需要根据 CPU 当前的状态来产生相应的控制信号，因此“标志”也是输入信号
- 来自总线的控制信号，如中断请求等

控制器的输出信号:

- CPU 内的控制信号: CPU 内的数据传输，或控制 ALU 执行不同的运算等
- 送至系统总线的信号: 如控制主存读/写，I/O 操作，中断响应等

## CPU 内部采用总线方式的控制信号与数据通路

- bus: CPU 内部的总线, 用来在 CPU 内部传输数据
- Y 和 Z 寄存器: 用于暂时存储参与运算的数据和中间结果
- 红线: CU 的控制信号
- 黑线: 数据

![](../img/cu1.jpg)

取指周期:

1. PC 中的数据送入 MAR
   - PC<sub>out</sub> 和 MAR<sub>in</sub> 有效
   - (PC) -> bus -> MAR
2. CU 通过控制总线向主存发送读信号: 1 -> 控制总线 -> R
3. 把指令从主存送入 MDR:
   - MDR<sub>in</sub> 有效
   - M(MAR) -> 数据总线 -> MDR
4. 把指令从 MDR 送入 IR:
   - MDR<sub>out</sub> 和 IR<sub>in</sub> 有效
   - (MDR) -> bus -> IR
5. 把操作码送入 CU 译码: OP(IR) -> CU
6. PC 自增: (PC) + 1 -> PC

间指周期:

1. 将指令的地址码送入 MAR
   - IR<sub>out</sub> 和 MAR<sub>in</sub> 有效
   - Ad(IR) -> bus -> MAR
2. 向主存发送读命令, 启动主存执行读操作: 1 -> R
3. 把有效地址从主存送入 MDR
   - MDR<sub>in</sub> 有效
   - M(MAR) -> 数据总线 -> MDR
4. 用有效地址覆盖 IR 中的地址码
   - IR<sub>in</sub> 有效
   - MDR -> bus -> Ad(IR)
