# 总线定时

总线在双方交换数据的过程中需要时间上的配合，这种关系称为总线定时，实质是一种协议或规则，有同步与异步两种。

## 总线传输的四个阶段

1. 申请分配: 主模块(主设备)提出申请，经过总线仲裁机构决定下一个传输周期总线给谁用
2. 寻址: 取得了使用权的主模块(主设备)通过总线发送本次要访问的从模块(从设备)的地址及有关命令，启动参与本次传输的从模块
3. 传输: 主从模块开始数据交换
4. 结束: 主模块相关信息撤出系统总线，让出使用权

这四个阶段称之为总线周期。

## 同步定时方式

系统采用统一的时钟信号来协调发送接收双方的传送定时关系。

优点: 规定明确，统一性强，模块间的配合简单一致。

缺点: 从模块时间配合属于强制“同步”，必须在限定时间内完成规定的要求，这就造成必须按照速度最慢的部件来设计公共时钟, 效率低、设计灵活性差。

## 异步定时方式

没有统一的时钟，没有固定的时间间隔。完全依靠双方相互制约的“握手”信号实现定时控制。

开始传输之前主设备会向从设备发出请求，并且会一直等到从设备发来响应信号后才开始数据传输。

根据请求和回答信号的撤销是否互锁, 分为三种类型:

- 不互锁方式: 主设备发出“请求”信号后，不必等到接到从设备的“回答”信号，而是经过一段时间便撤销“请求”信号。而从设备在接到“请求”信号后，发出“回答”信号，并经过一段时间，自动撤销“回答”信号，双方不存在互锁关系
- 半互锁方式: 主设备发出“请求”信号后，必须待接到从设备的“回答”信号后，才撤销“请求”信号，有互锁的关系。而从设备在接到“请求”信号后，发出“回答”信号，但不必等待获知主设备的“请求”信号己经撤销，而是隔一段时间后自动撤销“回答”信号，不存在互锁关系
- 全互锁方式: 主设备发出“请求”信号后，必须待从设备“回答”后，才撤销“请求”信号；从设备发出“回答”信号，必须待获知主设备“请求”信号己撤销后，再撤销其“回答”信号。双方存在互锁关系
