# 循环不变量

循环不变量(Loop Invariant)是指在循环执行过程中始终保持为真的条件或性质。它可以指导循环的设计与调试(若不变量被破坏，说明循环逻辑有误)。

核心特点：

- 初始化：循环开始前，不变量为真
- 保持性：如果某一轮循环开始时不变量为真，那么这一轮循环结束后它仍然为真(循环体会维持这个循环不变量)
- 终止性：当循环终止时，不变量结合循环条件的否定，能够证明算法的正确性(如达到预期目标)

下面线性查找算法的循环不变量: 在循环的第 i 次迭代开始前，`data[0...i)` 中不包含目标值 target。

```java
public static <E> int search(E[] data, E target) {
    for (int i = 0; i < data.length; i++) {
        if (data[i].equals(target)) {
            return i;
        }
    }
    return -1;
}
```

1. 初始化: 循环开始前 i = 0, 此时 "`data[0...0)` 中不包含 target" 显然为真，满足不变量
2. 保持性: 假设某次迭代开始时，i = k，且不变量成立(即 `data[0..k)` 中不包含 target)。进入循环后，程序会检查 `data[k]`:
   - 若 `data[k]` 等于 target，则直接返回 k，循环终止(此时已找到目标)
   - 若 `data[k]` 不等于 target，则 i 递增为 k+1，此时 "`data[0..k)` 中不包含 target" 依然成立，不变量保持为真
3. 终止性: 循环终止有两种情况:
   - 找到目标并返回: 此时根据循环逻辑，`data[i]` 等于 target，结合不变量(`data[0..i)` 中不包含 target)，说明 i 是 target 在数组中首次出现的索引，结果正确
   - 循环正常结束(i = data.length)：结合不变量可知，`data[0..data.length)` 中不包含 target，因此返回 -1 是正确的
