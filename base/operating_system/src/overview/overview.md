# 操作系统概述

操作系统(Operating System)是配置在计算机硬件上的第一层软件。

## 操作系统的特点

- 并发性: CPU 在一定时间间隔内在多个任务之间飞速切换
- 共享性: 系统内的资源可供多个并发的线程共同使用
  - 互斥共享方式: 比如麦克风, 多个程序不能同时使用
  - 同时访问方式: 一块内存单元, 由于 CPU 快速切换, 宏观上看起来像所有程序共享使用
- 虚拟性: 把一个物理实体变成若干个逻辑上的对应物
  - 时分复用技术: 比如 CPU 在不同线程之间飞速切换, 宏观上看起来像有多个 CPU 同时执行一样
  - 空分复用技术: 比如 C 盘, D 盘, E 盘, 看起来像有多个物理磁盘一样
- 异步性: 多个线程以断断续续、不可预知的速度执行

## 操作系统的功能

- 用户与硬件的接口
  - 命令方式: 比如 DOS
    - 联机命令(交互式命令): 逐条地输入命令, 比如使用命令行
    - 脱机命令(批处理命令): 一次性把命令写完, 统一执行, 比如 shell 脚本
  - 系统调用方式: 调用操作系统提供的函数
  - 图形、窗口方式: 比如 Windows
- 资源管理者
  - 处理机管理: 分配处理机给某个任务
  - 存储器管理: 负责内存的分配和回收
  - I/O 设备管理
  - 文件管理
- 扩充机器(虚机): 同样一台机器, 安装不同的软件可以表现出不同的功能

## 操作系统的发展和分类

1. 手工操作(无操作系统)
2. 批处理系统
   - 单道批处理系统: 没有并发性, 遇到 I/O 操作时, CPU 无事可做
   - 多道批处理系统: 有并发性
3. 分时系统
4. 实时系统: 在规定时间内完成任务(实时性)
5. 微机操作系统
   - 单用户单任务系统: MS-DOS
   - 单用户多任务系统: Windows 98
   - 多用户多任务系统: windows 7, Unix, Linux

## 内核态和用户态

用户态(User Mode)又叫目态, 在用户态下只能执行非特权指令。

内核态(Kernel Mode)又叫管态, 在内核态下可以执行全部指令。通常操作系统在内核态下运行。

## 陷入指令

陷入指令(Trap Instruction)是一种特殊的指令, 用于在程序中主动触发中断或异常。当执行到陷入指令时, CPU 会暂停当前程序的执行, 并转而执行由陷入指令所指定的中断处理程序或异常处理程序。陷入指令通常用于实现系统调用。

## 系统调用的过程

1. 应用程序发起系统调用
2. 切换到内核态
3. 执行系统调用
4. 返回结果给应用程序
5. 切换回用户态
