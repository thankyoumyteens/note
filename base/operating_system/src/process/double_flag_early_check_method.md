# 双标志先检查法

双标志先检查法(Double Flag Early Check Method)是一种软件实现进程互斥的策略, 主要用于解决并发环境中的临界区访问问题。在这种方法中, 每个进程在进入临界区之前先检查当前有没有别的进程想进入临界区, 如果没有, 则把自身对应的标志设为 true, 之后开始访问临界区。

### 工作原理

1. **初始化标志位**: 进程 0 和进程 1 都有一个对应的标志位`flag[0]`和一个`flag[1]`。`flag[i]`用于表示进程 i 是否想要进入临界区

2. **进入临界区**: 进程 0 在尝试进入临界区时, 首先检查`flag[1]`(另一个进程的标志位)是否为真(表示另一个进程可能在临界区或正尝试进入)。如果`flag[1]`为真, 进程 0 进入忙等待循环, 不断检查`flag[1]`的状态

3. **进入临界区后**: 一旦进程 0 确认可以进入临界区(即`flag[1]`为假), 它将`flag[0]`设置为真, 表示它现在正在临界区内

4. **离开临界区**: 进程 0 在离开临界区时, 将`flag[0]`设置为假, 表示它已经离开临界区, 并且现在允许其他进程进入

双标志先检查法的问题是先"检查"(检查`flag[1]`是否为真)后"上锁"(将`flag[0]`设置为真), 但是这两个操作又无法一气呵成, 因此存在两个进程同时进入临界区的问题, 违反了忙则等待原则。
